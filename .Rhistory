colnames(anno_file_1) <- NULL
head(anno_file_1)
write.table(anno_file_1, file = "anno_file_1.txt", quote = FALSE, sep="\t")
chr_file_1 = "chr_file_1.txt"
anno_file_1 = "anno_file_1.txt"
chromoMap(chr_file_1, anno_file_1)
anno_file_1[anno_file_1 == "ClassA"] <- "g1"
print(anno_file_1)
anno_file_1[anno_file_1 == "ClassA"] <- "g1"
head(anno_file_1)
anno_file_1 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_1) <- NULL
head(anno_file_1)
anno_file_1[anno_file_1 == "ClassA"] <- "g1"
anno_file_1$nm[anno_file_1$nm == "ClassA"] <- "g1"
anno_file_2 <- anno_file_1
head(anno_file_2)
anno_file_2 <- anno_file_1
anno_file_2[anno_file_2 == "ClassA"] <- "g1"
anno_file_2 <- anno_file_1
anno_file_2[-1][anno_file_2[-1] == "ClassA"] <- "g1"
character(class)
is.character(class)
?character
as.character(class)
toString(class)
toString("class")
is.character(class)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
print(merged_peaks_and_class)
class(merged_peaks_and_class$class)
is.character(merged_peaks_and_class$class)
anno_file_1 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_1) <- NULL
head(anno_file_1)
write.table(anno_file_1, file = "anno_file_1.txt", quote = FALSE, sep="\t")
chr_file_1 = "chr_file_1.txt"
anno_file_1 = "anno_file_1.txt"
chromoMap(chr_file_1, anno_file_1)
chromoMap("chr_file_1.txt", "anno_file_1.txt")
class(merged_peaks_and_class$class)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$class)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
as.character(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$seqnames)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$seqnames)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
print(merged_peaks_and_class)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$class)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
anno_file_1 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_1) <- NULL
head(anno_file_1)
write.table(anno_file_1, file = "anno_file_1.txt", quote = FALSE, sep="\t")
chr_file_1 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
colnames(chr_file_1) <- NULL
chr_file_1$seqnames <- as.character(chr_file_1$seqnames)
chr_file_1 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_1$seqnames <- as.character(chr_file_1$seqnames)
class(chr_file_1$seqnames)
colnames(chr_file_1) <- NULL
head(chr_file_1)
write.table(chr_file_1, file = "chr_file_1.txt", quote = FALSE, sep="\t")
chr_file_1 = "chr_file_1.txt"
anno_file_1 = "anno_file_1.txt"
chromoMap(chr_file_1, anno_file_1)
?as.numeric
chr_file_1 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_1$seqnames <- as.character(chr_file_1$seqnames)
class(chr_file_1$seqnames)
chr_file_1$start_position <- as.numeric(chr_file_1$start_positon)
chr_file_1 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_1$seqnames <- as.character(chr_file_1$seqnames)
class(chr_file_1$seqnames)
chr_file_1$start_position <- as.numeric(chr_file_1$start_position)
class(chr_file_1$start_position)
chr_file_1$end_position <- as.numeric(chr_file_1$end_position)
class(chr_file_1$end_position)
colnames(chr_file_1) <- NULL
write.table(chr_file_1, file = "chr_file_1.txt", quote = FALSE, sep="\t")
head(chr_file_1)
head(elt2_peaks_L1_IDR)
bound_genes_class_assignments <- read.table("Bound_Genes_Class_Assignments.txt", header = TRUE, sep = ",", dec = ".")
bound_class_assignments <- as.data.frame(bound_genes_class_assignments)
merged_peaks_with_class_assignments <- merge(x=bound_class_assignments, y=elt2_peaks_L1_IDR, by.x="WBGeneID", by.y="feature")
print(merged_peaks_with_class_assignments)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$seqnames)
chr_file_1$start_position <- as.numeric(chr_file_1$start_position)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$seqnames)
merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$start_position)
merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
class(merged_peaks_and_class$end_position)
print(merged_peaks_and_class)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$seqnames)
merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$start_position)
merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
class(merged_peaks_and_class$end_position)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$class)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
anno_file_1 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_1) <- NULL
head(anno_file_1)
write.table(anno_file_1, file = "anno_file_1.txt", quote = FALSE, sep="\t")
chr_file_1 = "chr_file_1.txt"
anno_file_1 = "anno_file_1.txt"
chromoMap(chr_file_1, anno_file_1)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("knitr")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("ggpubr")
# install.packages("mratios")
# install.packages("dplyr")
# install.packages("chromoMap")
library(readxl)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(mratios)
library(chromoMap)
elt2_GRange <- readRDS("annotatedPeaks.rds")
elt2_peaks <- as.data.frame(elt2_GRange)
elt2_peaks %>% head()
colnames(elt2_peaks)
elt2_peaks_L1_IDR <- elt2_peaks %>%
filter(L1_IDR == 1)
chr_file_1 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_1$seqnames <- as.character(chr_file_1$seqnames)
class(chr_file_1$seqnames)
chr_file_1$start_position <- as.numeric(chr_file_1$start_position)
class(chr_file_1$start_position)
chr_file_1$end_position <- as.numeric(chr_file_1$end_position)
class(chr_file_1$end_position)
colnames(chr_file_1) <- NULL
head(chr_file_1)
write.table(chr_file_1, file = "chr_file_1.txt", quote = FALSE, sep="\t")
head(elt2_peaks_L1_IDR)
bound_genes_class_assignments <- read.table("Bound_Genes_Class_Assignments.txt", header = TRUE, sep = ",", dec = ".")
bound_class_assignments <- as.data.frame(bound_genes_class_assignments)
merged_peaks_with_class_assignments <- merge(x=bound_class_assignments, y=elt2_peaks_L1_IDR, by.x="WBGeneID", by.y="feature")
print(merged_peaks_with_class_assignments)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
print(merged_peaks_and_class)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$class)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
anno_file_1 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_1) <- NULL
head(anno_file_1)
write.table(anno_file_1, file = "anno_file_1.txt", quote = FALSE, sep="\t")
chr_file_1 = "chr_file_1.txt"
anno_file_1 = "anno_file_1.txt"
chromoMap(chr_file_1, anno_file_1)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("knitr")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("ggpubr")
# install.packages("mratios")
# install.packages("dplyr")
# install.packages("chromoMap")
library(readxl)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(mratios)
library(chromoMap)
elt2_GRange <- readRDS("annotatedPeaks.rds")
elt2_peaks <- as.data.frame(elt2_GRange)
elt2_peaks %>% head()
colnames(elt2_peaks)
elt2_peaks_L1_IDR <- elt2_peaks %>%
filter(L1_IDR == 1)
chr_file_2 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_2$seqnames <- as.character(chr_file_2$seqnames)
class(chr_file_2$seqnames)
chr_file_2$start_position <- as.numeric(chr_file_2$start_position)
class(chr_file_2$start_position)
chr_file_2$end_position <- as.numeric(chr_file_2$end_position)
class(chr_file_2$end_position)
colnames(chr_file_2) <- NULL
head(chr_file_2)
write.table(chr_file_2, file = "chr_file_2.txt", quote = FALSE, sep="\t")
head(elt2_peaks_L1_IDR)
bound_genes_class_assignments <- read.table("Bound_Genes_Class_Assignments.txt", header = TRUE, sep = ",", dec = ".")
bound_class_assignments <- as.data.frame(bound_genes_class_assignments)
merged_peaks_with_class_assignments <- merge(x=bound_class_assignments, y=elt2_peaks_L1_IDR, by.x="WBGeneID", by.y="feature")
print(merged_peaks_with_class_assignments)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
# merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
# merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
# merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
print(merged_peaks_and_class)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$class)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
anno_file_2 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_1) <- NULL
head(anno_file_1)
write.table(anno_file_2, file = "anno_file_2.txt", quote = FALSE, sep="\t")
chr_file_2 = "chr_file_2.txt"
anno_file_2 = "anno_file_2.txt"
chromoMap(chr_file_2, anno_file_2)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("knitr")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("ggpubr")
# install.packages("mratios")
# install.packages("dplyr")
# install.packages("chromoMap")
library(readxl)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(mratios)
library(chromoMap)
elt2_GRange <- readRDS("annotatedPeaks.rds")
elt2_peaks <- as.data.frame(elt2_GRange)
elt2_peaks %>% head()
colnames(elt2_peaks)
elt2_peaks_L1_IDR <- elt2_peaks %>%
filter(L1_IDR == 1)
chr_file_2 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_2$seqnames <- as.character(chr_file_2$seqnames)
class(chr_file_2$seqnames)
chr_file_2$start_position <- as.numeric(chr_file_2$start_position)
class(chr_file_2$start_position)
chr_file_2$end_position <- as.numeric(chr_file_2$end_position)
class(chr_file_2$end_position)
colnames(chr_file_2) <- NULL
head(chr_file_2)
write.table(chr_file_2, file = "chr_file_2.txt", quote = FALSE, sep="\t")
head(elt2_peaks_L1_IDR)
bound_genes_class_assignments <- read.table("Bound_Genes_Class_Assignments.txt", header = TRUE, sep = ",", dec = ".")
bound_class_assignments <- as.data.frame(bound_genes_class_assignments)
merged_peaks_with_class_assignments <- merge(x=bound_class_assignments, y=elt2_peaks_L1_IDR, by.x="WBGeneID", by.y="feature")
print(merged_peaks_with_class_assignments)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
print(merged_peaks_and_class)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("knitr")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("ggpubr")
# install.packages("mratios")
# install.packages("dplyr")
# install.packages("chromoMap")
library(readxl)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(mratios)
library(chromoMap)
elt2_GRange <- readRDS("annotatedPeaks.rds")
elt2_peaks <- as.data.frame(elt2_GRange)
elt2_peaks %>% head()
colnames(elt2_peaks)
elt2_peaks_L1_IDR <- elt2_peaks %>%
filter(L1_IDR == 1)
chr_file_2 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_2$seqnames <- as.character(chr_file_2$seqnames)
class(chr_file_2$seqnames)
chr_file_2$start_position <- as.numeric(chr_file_2$start_position)
class(chr_file_2$start_position)
chr_file_2$end_position <- as.numeric(chr_file_2$end_position)
class(chr_file_2$end_position)
colnames(chr_file_2) <- NULL
head(chr_file_2)
write.table(chr_file_2, file = "chr_file_2.txt", quote = FALSE, sep="\t")
head(elt2_peaks_L1_IDR)
bound_genes_class_assignments <- read.table("Bound_Genes_Class_Assignments.txt", header = TRUE, sep = ",", dec = ".")
bound_class_assignments <- as.data.frame(bound_genes_class_assignments)
merged_peaks_with_class_assignments <- merge(x=bound_class_assignments, y=elt2_peaks_L1_IDR, by.x="WBGeneID", by.y="feature")
print(merged_peaks_with_class_assignments)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
print(merged_peaks_and_class)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$class)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
anno_file_2 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_1) <- NULL
head(anno_file_1)
write.table(anno_file_2, file = "anno_file_2.txt", quote = FALSE, sep="\t")
chr_file_2 = "chr_file_2.txt"
anno_file_2 = "anno_file_2.txt"
chromoMap(chr_file_2, anno_file_2)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("knitr")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("ggpubr")
# install.packages("mratios")
# install.packages("dplyr")
# install.packages("chromoMap")
library(readxl)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(mratios)
library(chromoMap)
elt2_GRange <- readRDS("annotatedPeaks.rds")
elt2_peaks <- as.data.frame(elt2_GRange)
elt2_peaks %>% head()
colnames(elt2_peaks)
elt2_peaks_L1_IDR <- elt2_peaks %>%
filter(L1_IDR == 1)
chr_file_2 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_2$seqnames <- as.character(chr_file_2$seqnames)
class(chr_file_2$seqnames)
chr_file_2$start_position <- as.numeric(chr_file_2$start_position)
class(chr_file_2$start_position)
chr_file_2$end_position <- as.numeric(chr_file_2$end_position)
class(chr_file_2$end_position)
colnames(chr_file_2) <- NULL
head(chr_file_2)
write.table(chr_file_2, file = "chr_file_2.txt", quote = FALSE, sep="\t")
head(elt2_peaks_L1_IDR)
bound_genes_class_assignments <- read.table("Bound_Genes_Class_Assignments.txt", header = TRUE, sep = ",", dec = ".")
bound_class_assignments <- as.data.frame(bound_genes_class_assignments)
merged_peaks_with_class_assignments <- merge(x=bound_class_assignments, y=elt2_peaks_L1_IDR, by.x="WBGeneID", by.y="feature")
print(merged_peaks_with_class_assignments)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
print(merged_peaks_and_class)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$class)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
anno_file_2 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_2) <- NULL
head(anno_file_2)
write.table(anno_file_2, file = "anno_file_2.txt", quote = FALSE, sep="\t")
chr_file_2 = "chr_file_2.txt"
anno_file_2 = "anno_file_2.txt"
chromoMap(chr_file_2, anno_file_2)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("knitr")
# install.packages("readxl")
# install.packages("tidyverse")
# install.packages("ggpubr")
# install.packages("mratios")
# install.packages("dplyr")
# install.packages("chromoMap")
library(readxl)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(mratios)
library(chromoMap)
elt2_GRange <- readRDS("annotatedPeaks.rds")
elt2_peaks <- as.data.frame(elt2_GRange)
elt2_peaks %>% head()
colnames(elt2_peaks)
elt2_peaks_L1_IDR <- elt2_peaks %>%
filter(L1_IDR == 1)
chr_file_2 <- elt2_peaks_L1_IDR %>%
select(seqnames, start_position, end_position) %>%
remove_rownames
chr_file_2$seqnames <- as.character(chr_file_2$seqnames)
class(chr_file_2$seqnames)
chr_file_2$start_position <- as.numeric(chr_file_2$start_position)
class(chr_file_2$start_position)
chr_file_2$end_position <- as.numeric(chr_file_2$end_position)
class(chr_file_2$end_position)
colnames(chr_file_2) <- NULL
head(chr_file_2)
write.table(chr_file_2, file = "chr_file_2.txt", quote = FALSE, sep="\t")
head(elt2_peaks_L1_IDR)
bound_genes_class_assignments <- read.table("Bound_Genes_Class_Assignments.txt", header = TRUE, sep = ",", dec = ".")
bound_class_assignments <- as.data.frame(bound_genes_class_assignments)
merged_peaks_with_class_assignments <- merge(x=bound_class_assignments, y=elt2_peaks_L1_IDR, by.x="WBGeneID", by.y="feature")
print(merged_peaks_with_class_assignments)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
print(merged_peaks_and_class)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
class(merged_peaks_and_class$class)
anno_file_2 <- merged_peaks_and_class %>%
select(WBGeneID, seqnames, start_position, end_position, class) %>%
remove_rownames
colnames(anno_file_2) <- NULL
head(anno_file_2)
write.table(anno_file_2, file = "anno_file_2.txt", quote = FALSE, sep="\t")
chr_file_2 = "chr_file_2.txt"
anno_file_2 = "anno_file_2.txt"
chromoMap(chr_file_2, anno_file_2)
merged_peaks_and_class$class <- as.numeric(merged_peaks_and_class$class)
merged_peaks_and_class <- merged_peaks_with_class_assignments %>%
mutate(
L1_peak_summit_mean = rowMeans(merged_peaks_with_class_assignments[,c('L1_peak_1_summit', 'L1_peak_2_summit')], na.rm=TRUE)
)
merged_peaks_and_class$seqnames <- as.character(merged_peaks_and_class$seqnames)
merged_peaks_and_class$start_position <- as.numeric(merged_peaks_and_class$start_position)
merged_peaks_and_class$end_position <- as.numeric(merged_peaks_and_class$end_position)
print(merged_peaks_and_class)
class(merged_peaks_and_class$WBGeneID)
class(merged_peaks_and_class$seqnames)
class(merged_peaks_and_class$start_position)
class(merged_peaks_and_class$end_position)
class(merged_peaks_and_class$class)
